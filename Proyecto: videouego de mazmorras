// podriamos usar las ── y │ como paredes
// che, recomiendo que cuando cada uno actualice su codigo, ponga sus ideas que aun no puso y explique algunas partes
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void limpiar_consola() {
    printf("\033[H\033[J");
}

void bienvenida(char nombre[20]) {
    while (1) {
        puts("Bienvenido jugador. Ingrese su nombre: ");
        scanf("%s", nombre);
        limpiar_consola();
        break;
    }
}

void rellenarMazmorras(int tamañomazmorra, char dungeon[tamañomazmorra][tamañomazmorra], int dificultad) {
    srand(time(NULL));
    int r;
    char enemigos[2] = {'1', '2'};
    for (int i = 0; i < tamañomazmorra; i++) {
        for (int j = 0; j < tamañomazmorra; j++) {
            r = rand() % 10;
            if (r > dificultad) {
                dungeon[i][j] = '*';
            } else {
                dungeon[i][j] = enemigos[rand() % 2];
            }
        }
    }
    dungeon[0][0] = '*';
}

void imprimirMazmorra(int tamañoDungeon, char dungeon[tamañoDungeon][tamañoDungeon], int fila, int columna) {
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 3; j++) {
            printf("%c ", dungeon[fila + i][columna + j]);
        }
        printf("\n");
    }
}

void actualizar_mazmorra(int n, char mazmorra[n][n], int fila, int columna, int fila_nueva, int columna_nueva) {
    mazmorra[fila][columna] = '*';
    mazmorra[fila_nueva][columna_nueva] = '5';
}

int movimientos(int Nmazmorra, int tamañoDungeon, char mazmorra[tamañoDungeon][tamañoDungeon]) {
    srand(time(NULL));
    int fila = rand() % Nmazmorra;
    int columna = rand() % Nmazmorra;
    int nuevafila = fila;
    int nuevacolumna = columna;
    char movimiento;
    limpiar_consola();
    imprimirMazmorra(tamañoDungeon, mazmorra, fila, columna);
    while (1) {
        scanf(" %c", &movimiento);
        if (movimiento == 'w') {
            nuevafila = fila - 1;
            nuevacolumna = columna;
        } else if (movimiento == 'a') {
            nuevafila = fila;
            nuevacolumna = columna - 1;
        } else if (movimiento == 's') {
            nuevafila = fila + 1;
            nuevacolumna = columna;
        } else if (movimiento == 'd') {
            nuevafila = fila;
            nuevacolumna = columna + 1;
        } else {
            limpiar_consola();
            imprimirMazmorra(tamañoDungeon, mazmorra, fila, columna);
            puts("Opción inválida");
            continue;
        }
        if (nuevafila < 0 || nuevafila >= Nmazmorra || nuevacolumna < 0 || nuevacolumna >= Nmazmorra) {
            puts("Movimiento fuera de los límites.");
            continue;
        }
        actualizar_mazmorra(tamañoDungeon, mazmorra, fila, columna, nuevafila, nuevacolumna);
        fila = nuevafila;
        columna = nuevacolumna;
        limpiar_consola();
        imprimirMazmorra(tamañoDungeon, mazmorra, fila, columna);
    }
    return 0;
}

int main(int argc, char *argv[]) {
    char mazmorra1[15][15];
    char mazmorra2[20][20];
    char mazmorra3[30][30];
    int opcion;
    char nombre[20];
    puts("┌──────────────────────────────────────┐");
    puts("│           Juego de Mazmorra           │");
    puts("└───────────────────────────────────────┘");
    bienvenida(nombre);
    puts("  Menú:");
    puts("  1. Jugar");
    puts("  2. Reglas");
    puts("  3. Controles");
    puts("  4. Enemigos");
    puts("  5. Items");
    puts("  6. Salir");
    scanf("%d", &opcion);
    switch (opcion) {
        case 1:
            limpiar_consola();
            rellenarMazmorras(15, mazmorra1, 4);
            movimientos(15, 15, mazmorra1);
            break;
        case 2:
            limpiar_consola();
            puts("┌────────────────────────────────┐");
            puts("│    Reglas del juego:           │");
            puts("├────────────────────────────────┤");
            puts("│- Tienes que llegar hasta        │");
            puts("│  la mazmorra 3 y vencer al     │");
            puts("│  jefe.                         │");
            puts("│                                │");
            puts("│- En cada mazmorra              │");
            puts("│  habrán enemigos que           │");
            puts("│  tratarán de matarte           │");
            puts("│                                │");
            puts("│- También habrán                │");
            puts("│  objetos que mejorarán tus     │");
            puts("│  capacidades, como la vida     │");
            puts("│  o la fuerza.                  │");
            puts("└────────────────────────────────┘");
            puts("Presiona Enter para salir");
            getchar(); getchar();
            break;
        case 3:
            limpiar_consola();
            puts("        ┌─────┐               w: moverte hacia arriba");
            puts("        │  w  │");
            puts("        └─────┘               a: moverte hacia la izquierda");
            puts("┌─────┐ ┌─────┐  ┌─────┐");
            puts("│  a  │ │  s  │  │  d  │      s: moverte hacia abajo");
            puts("└─────┘ └─────┘  └─────┘");
            puts("                              d: moverte hacia la derecha");
            break;
        case 4:
            limpiar_consola();
            puts("1: Tiene x cantidad de vida. Te quita x cantidad de vida");
            puts("2: Tiene x cantidad de vida. Te quita x cantidad de vida");
            break;
        case 5:
            limpiar_consola();
            puts("3: te da un aumento de vida de x cantidad");
            puts("4: te da un aumento de vida de x cantidad");
            break;
        case 6:
            limpiar_consola();
            puts("Saliendo...");
            break;
        default:
            puts("Opción inválida");
            break;
    }

    return 0;
}

